(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cd2bf2b"],{"7f7f":function(e,t,s){var n=s("86cc").f,i=Function.prototype,a=/^\s*function ([^ (]*)/,r="name";r in i||s("9e1e")&&n(i,r,{configurable:!0,get:function(){try{return(""+this).match(a)[1]}catch(e){return""}}})},"91f9":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticStyle:{border:"1px",width:"100%",height:"100%","box-shadow":"0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)"}},[s("el-container",[s("el-header",{staticStyle:{display:"flex","align-items":"center"}},[s("div",[s("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){e.addVis=!0}}},[e._v("添加用户")])],1),s("br")]),s("el-main",[s("div",[s("h1",[e._v("普通用户")])]),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.users,title:"普通用户列表",size:"mini"}},[e._e(),s("el-table-column",{attrs:{prop:"name",label:"姓名",width:"100"}}),s("el-table-column",{attrs:{prop:"number",label:"学工号",width:"150"}}),s("el-table-column",{attrs:{prop:"title",label:"职称",width:"90"}}),s("el-table-column",{attrs:{prop:"introduction",label:"简介",width:"180"}}),s("el-table-column",{attrs:{prop:"phone",label:"电话",width:"140"}}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini"},on:{click:function(s){return e.showEditEmpView(t.row)}}},[e._v("编辑")]),s("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(s){return e.open(t.row)}}},[e._v("授权")]),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.resetPass(t.row)}}},[e._v("密码重置")])]}}])})],1),e.superAdmin?s("div",[s("h1",[e._v("管理员")]),s("el-table",{attrs:{data:e.adminusers,size:"mini"}},[e._e(),s("el-table-column",{attrs:{prop:"number",label:"学工号"}}),s("el-table-column",{attrs:{prop:"name",label:"姓名"}}),s("el-table-column",{attrs:{prop:"phone",label:"电话"}}),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(s){return e.cancelAuthority(t.row)}}},[e._v("取消授权")])]}}],null,!1,3534344466)})],1)],1):e._e()],1)],1),s("el-form",{attrs:{model:e.user}},[s("div",{staticStyle:{"text-align":"left"}},[s("el-dialog",{staticStyle:{padding:"0px"},attrs:{title:e.dialogTitle,"close-on-click-modal":!1,visible:e.dialogVisible,width:"77%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("el-container",[s("el-header",[s("el-button",{attrs:{type:"warning",size:"mini"},on:{click:e.deleteUser}},[e._v("删除该员工")])],1),s("el-main",[s("div",[s("el-row",[s("el-col",{attrs:{span:6}},[s("div",[s("el-form-item",{attrs:{label:"姓名:",prop:"name"}},[s("el-input",{staticStyle:{width:"130px"},attrs:{"prefix-icon":"el-icon-edit",size:"mini",placeholder:"请输入员工姓名"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1)],1)]),s("el-col",{attrs:{span:7}},[s("div",[s("el-form-item",{attrs:{label:"学工号"}},[s("el-input",{staticStyle:{width:"140px"},attrs:{"prefix-icon":"el-icon-set-up",size:"mini",disabled:"true"},model:{value:e.user.number,callback:function(t){e.$set(e.user,"number",t)},expression:"user.number"}})],1)],1)]),s("el-col",{attrs:{span:5}},[s("div",[s("el-form-item",{attrs:{label:"电话"}},[s("el-input",{staticStyle:{width:"140px"},attrs:{"prefix-icon":"el-icon-phone",size:"mini",placeholder:"请输入员工电话"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1)],1)]),s("el-col",{attrs:{span:5}},[s("div",[s("el-form-item",{attrs:{label:"职称"}},[s("el-select",{staticStyle:{width:"130px"},attrs:{size:"mini",placeholder:"请选择职位"},model:{value:e.user.title,callback:function(t){e.$set(e.user,"title",t)},expression:"user.title"}},e._l(e.positions,function(e){return s("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})}),1)],1)],1)])],1),s("el-row",[s("el-col",[s("el-form-item",{attrs:{label:"个人简介"}},[s("el-input",{attrs:{type:"text"},model:{value:e.user.introduction,callback:function(t){e.$set(e.user,"introduction",t)},expression:"user.introduction"}})],1)],1)],1)],1)])],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"mini"},on:{click:e.cancelEidt}},[e._v("取 消")]),s("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return e.postUser(e.user)}}},[e._v("确 定")])],1)],1)],1)]),s("el-dialog",{attrs:{title:"增加用户",visible:e.addVis},on:{"update:visible":function(t){e.addVis=t}}},[s("el-form",{ref:"newUser",attrs:{model:e.newUser,rules:e.rules}},[s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-edit","auto-complete":"off"},model:{value:e.newUser.name,callback:function(t){e.$set(e.newUser,"name",t)},expression:"newUser.name"}})],1),s("el-form-item",{attrs:{label:"学工号",prop:"number"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-set-up","auto-complete":"off"},model:{value:e.newUser.number,callback:function(t){e.$set(e.newUser,"number",t)},expression:"newUser.number"}})],1),s("el-form-item",{attrs:{label:"初始密码",prop:"password"}},[s("el-input",{attrs:{"prefix-icon":"el-icon-set-up","auto-complete":"off"},model:{value:e.newUser.password,callback:function(t){e.$set(e.newUser,"password",t)},expression:"newUser.password"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.addVis=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addUser("newUser")}}},[e._v("确 定")])],1)],1),s("el-dialog",{attrs:{visible:e.resetVis},on:{"update:visible":function(t){e.resetVis=t}}},[s("el-form",{ref:"user",attrs:{rules:e.rules,model:e.user}},[s("el-form-item",{attrs:{label:"请输入新密码",prop:"password"}},[s("el-input",{model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.resetVis=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitPass("user")}}},[e._v("确 定")])],1)],1)],1)},i=[],a=(s("7f7f"),s("c991")),r=s("a27b"),o=s("5c96"),l=s("a0b5"),u={data:function(){return{users:[],adminusers:[],user:{id:"",authority:"",name:"",number:"",title:"",phone:"",introduction:"",password:""},newUser:{name:"",number:"",password:""},superAdmin:!1,dialogVisible:!1,dialogTitle:"",addVis:!1,resetVis:!1,positions:[{id:"1",name:"讲师"},{id:"2",name:"副教授"},{id:"3",name:"教授"}],rules:{name:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:3,max:20,message:"长度在3-20个字符之间",trigger:"blur"}],number:[{required:!0,message:"请输入学工号",trigger:"blur"}]}}},created:function(){var e=this;Object(l["e"])(),a["a"].$on(a["a"].users,function(t){e.users=t}),r["a"].get("/admin/adminusers").then(function(t){e.adminusers=t.data.users});var t=sessionStorage.getItem("role");"bv83f958a35ty8210nc9"==t&&(this.superAdmin=!0)},methods:{cancelAuthority:function(e){var t=this;this.user=e,r["a"].post("/set/user/cancel",this.user).then(function(e){200==e.status&&o["Message"].success("取消成功!"),r["a"].get("/admin/adminusers").then(function(e){t.adminusers=e.data.users}),Object(l["e"])()})},resetPass:function(e){this.resetVis=!0,this.user=e},submitPass:function(e){var t=this;this.$refs[e].validate(function(e){e&&r["a"].post("/admin/reset/pass",t.user).then(function(e){200==e.status&&(o["Message"].success("更新成功!"),t.resetVis=!1,t.user.password="")})})},cancelEidt:function(){this.dialogVisible=!1},showEditEmpView:function(e){this.dialogTitle="编辑员工",this.dialogVisible=!0,this.user=e,this.user.name=e.name,this.user.number=e.number,this.user.id=e.id,this.user.phone=e.phone,this.user.introduction=e.introduction},deleteUser:function(){var e=this;this.$confirm("确定删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){r["a"].post("/admin/remove",e.user).then(function(t){200==t.status&&(o["Message"].success("删除成功!"),e.dialogVisible=!1,Object(l["e"])())}).catch(function(){o["Message"].warning("未知错，删除失败")})})},postUser:function(e){Object(l["f"])(e)},addUser:function(e){var t=this;this.$refs[e].validate(function(e){e&&r["a"].post("/admin/new",t.newUser).then(function(e){200==e.status?(o["Message"].success("添加成功!"),t.newUser={number:null,name:null,password:null},t.addVis=!1,Object(l["e"])()):o["Message"].warning("未知错误")}).catch(function(){o["Message"].warning("学工号重复,添加失败")})})},open:function(e){var t=this;this.$confirm("确认授权管理员给【"+e.name+"】, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.user=e,r["a"].post("/set/user/authority",t.user).then(function(e){e&&200==e.status&&console.log("success"),r["a"].get("/admin/adminusers").then(function(e){t.adminusers=e.data.users}),Object(l["e"])()}),t.$message({type:"success",message:"授权成功!"})}).catch(function(){t.$message({type:"info",message:"已取消授权"})})}}},c=u,d=s("2877"),m=Object(d["a"])(c,n,i,!1,null,null,null);t["default"]=m.exports},a0b5:function(e,t,s){"use strict";s.d(t,"c",function(){return r}),s.d(t,"d",function(){return o}),s.d(t,"a",function(){return l}),s.d(t,"e",function(){return u}),s.d(t,"b",function(){return c}),s.d(t,"f",function(){return d});var n=s("a27b"),i=s("c991"),a=s("5c96");function r(){n["a"].get("/user").then(function(e){i["a"].$emit(i["a"].user,e.data.user)})}function o(){n["a"].get("/admin/task/list").then(function(e){i["a"].$emit(i["a"].tasks,e.data.tasks)})}function l(){n["a"].get("/lession/list").then(function(e){i["a"].$emit(i["a"].lessions,e.data.lessions)})}function u(){n["a"].get("/get/users").then(function(e){i["a"].$emit(i["a"].users,e.data.users)})}function c(){n["a"].get("/exam/admin/list").then(function(e){i["a"].$emit(i["a"].exams,e.data.exams)})}function d(e){n["a"].post("/set/update/user",e).then(function(e){setTimeout(function(){i["a"].$emit(i["a"].users,e.data.user)},500),a["Message"].success("修改成功")}).catch(function(){a["Message"].warning("未知错误，修改失败")})}}}]);